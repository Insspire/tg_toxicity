# Анализатор токсичности аудитории Telegram-каналов

Веб-приложение на Streamlit для анализа уровня токсичности комментариев в Telegram-каналах. Приложение использует обученную модель машинного обучения для классификации комментариев по категориям токсичности и предоставляет детальную статистику.

## Описание

Это приложение позволяет оценить уровень токсичности аудитории любого публичного Telegram-канала. Оно собирает комментарии из постов канала, анализирует их с помощью нейросетевой модели и предоставляет:

- Общую статистику по токсичности
- Список обнаруженных токсичных комментариев
- Распределение по категориям токсичности
- Визуализацию результатов

## Как это работает

1. **Сбор данных**: Приложение подключается к Telegram API через библиотеку Telethon и собирает комментарии из указанного количества постов канала.

2. **Анализ токсичности**: Собранные комментарии обрабатываются обученной multilabel моделью на базе transformers, которая классифицирует каждый комментарий по следующим категориям:
   - **Нейтральный** — обычные комментарии без токсичности
   - **Оскорбление/мат** — комментарии, унижающие человека
   - **Угроза** — комментарии с намерением причинить вред
   - **Непристойность** — комментарии с описанием или угрозой сексуального насилия

3. **Оценка результатов**: Приложение рассчитывает процент токсичных комментариев и отображает детальную статистику с визуализацией.

## Требования

- Docker и Docker Compose
- Telegram API credentials (API_ID и API_HASH) — можно получить на [my.telegram.org](https://my.telegram.org)

## Запуск через Docker

### Быстрый старт

1. **Клонируйте репозиторий** (если еще не сделано):
   ```bash
   git clone https://github.com/Insspire/tg_toxicity.git
   cd tg_toxicity
   ```

2. **Настройте Telegram API credentials** (опционально):
   
   По умолчанию в приложении уже указаны API_ID и API_HASH. Если хотите использовать свои, отредактируйте файл `app/app.py`:
   ```python
   API_ID = "ваш_api_id"
   API_HASH = "ваш_api_hash"
   ```

3. **Запустите приложение через Docker Compose**:
   ```bash
   docker-compose up --build
   ```

4. **Откройте браузер** и перейдите по адресу:
   ```
   http://localhost:8501
   ```

### Остановка приложения

Для остановки контейнера используйте:
```bash
docker-compose down
```

### Пересборка образа

Если вы внесли изменения в код или зависимости, пересоберите образ:
```bash
docker-compose up --build
```

## Использование

1. Введите **username канала** (без символа @, например: `durov`)
2. Выберите **количество постов** для анализа (10, 50, 100, 200 или 300)
3. Выберите **количество комментариев** на пост (10, 50, 100, 300 или Все)
4. Нажмите кнопку **"Начать анализ"**

Приложение автоматически:
- Подключится к Telegram
- Соберет комментарии из указанных постов
- Проанализирует их с помощью модели
- Отобразит результаты с метриками и списком токсичных комментариев

## Особенности

- **Батчевая обработка**: Комментарии обрабатываются батчами для оптимизации производительности
- **Прогресс-бар**: Отслеживание прогресса обработки комментариев
- **Детальная статистика**: Разбивка по категориям токсичности
- **Предупреждения**: Система предупреждает о потенциально больших объемах данных

## Структура проекта

```
tg_toxicity/
├── app/
│   ├── app.py              # Основное Streamlit приложение
│   ├── src/
│   │   └── toxic_model.py  # Модель для анализа токсичности
│   └── models/
│       └── toxicity-multilabel-hn/  # Обученная модель
├── Dockerfile              # Конфигурация Docker образа
├── docker-compose.yml      # Конфигурация Docker Compose
└── pyproject.toml          # Зависимости проекта
```

## Примечания

- При первом запуске приложение может запросить авторизацию в Telegram (код из SMS)
- Сессия Telegram сохраняется в файле `session_app.session` для последующих запусков
- При выборе большого количества постов и комментариев анализ может занять значительное время
- Убедитесь, что канал является публичным и доступен для чтения

## Технологии

- **Streamlit** — веб-фреймворк для создания интерфейса
- **Telethon** — библиотека для работы с Telegram API
- **Transformers** — библиотека для работы с моделями машинного обучения
- **PyTorch** — фреймворк для глубокого обучения
- **Docker** — контейнеризация приложения
